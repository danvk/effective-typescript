<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    
    <title>Recommendation Update: ✂️ Use knip to detect dead code and types</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Khula:wght@600&family=Open+Sans:ital,wght@0,300;0,400;0,600;1,300;1,400;1,600&display=swap" rel="stylesheet">
    <link href="/css/customize.css" rel="stylesheet">
    <link href="/css/highlight.vs.css" rel="stylesheet">
    <link rel="icon" type="image/png" href="/images/icon.png">
    <meta name="description" content="Effective TypeScript: Recommendation Update: ✂️ Use knip to detect dead code and types">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:creator" content="@danvdk">
    <meta name="twitter:domain" content="effectivetypescript.com">
    <meta name="twitter:title" content="Effective TypeScript &rsaquo; Recommendation Update: ✂️ Use knip to detect dead code and types">
    <meta name="twitter:description" content="TL;DR: Use ts-prune is in maintenance mode. Use knip to find dead code instead. It&amp;#39;s great!">
    <meta name="twitter:img:src" content="https://effectivetypescript.com/images/cover-2e.jpg">

    <meta property="og:title" content="Effective TypeScript &rsaquo; Recommendation Update: ✂️ Use knip to detect dead code and types">
    <meta property="og:description" content="TL;DR: Use ts-prune is in maintenance mode. Use knip to find dead code instead. It&amp;#39;s great!">
    <meta property="og:image" content="https://effectivetypescript.com/images/cover-2e.jpg">
    <meta property="og:url" content="https://effectivetypescript.com/">

    <link href="https://effectivetypescript.com/atom.xml" type="application/atom+xml" rel="alternate" title="Effective TypeScript Atom Feed">
  <meta name="generator" content="Hexo 5.4.0"></head>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-1NXE8EL9YT"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-1NXE8EL9YT');
  var trackOutboundLink = function(category, url, e) {
    if (!window.google_tag_manager) {
      console.log('blocked!');
      return true;  // probably blocked
    }

    // No need to use event_callback if the link is opening in a new tab.
    var newTab = e && (e.metaKey || (e.currentTarget && e.currentTarget.target === '_blank'));
    gtag('event', 'click', {
        'event_category': category,
        'event_label': url,
        'transport_type': 'beacon',
        'event_callback': !newTab ? function() {
          document.location = url;
        } : undefined
    });

    return newTab;
  }
</script>

<body class="post">
  <div class="header">
  <div class="container">
      <div class="row">
          <div class="col-md-12">
              <h1 class="site-title">
                  <a href="/">
                      Effective TypeScript
                  </a>
              </h1>
          </div>
      </div>
  </div>
</div>

  <section id="content" class="article content">

  <div class="title-bar">
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <h2>Recommendation Update: ✂️ Use knip to detect dead code and types</h2>
        </div>
      </div>
    </div>
  </div>

  <div class="page-content">
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <div class="text-muted published-container">
            <time class="published" datetime="2023-07-29T14:20:00.000Z" itemprop="datePublished">
              Sat 29 July 2023
            </time>
          </div>
          <div class="entry-content">
            <p>TL;DR: Use <a target="_blank" rel="noopener" href="https://github.com/nadeesha/ts-prune" onclick="return trackOutboundLink('recommendation update  use knip to detect dead code and types', 'https://github.com/nadeesha/ts-prune', event);">ts-prune</a> is in maintenance mode. Use <a target="_blank" rel="noopener" href="https://github.com/webpro/knip" onclick="return trackOutboundLink('recommendation update  use knip to detect dead code and types', 'https://github.com/webpro/knip', event);">knip</a> to find dead code instead. It&#39;s great!</p>
<span id="more"></span>

<p>Three years ago I <a href="https://effectivetypescript.com/2020/10/20/tsprune/">recommended</a> using <code>--noUnusedLocals</code> and <a target="_blank" rel="noopener" href="https://github.com/nadeesha/ts-prune" onclick="return trackOutboundLink('recommendation update  use knip to detect dead code and types', 'https://github.com/nadeesha/ts-prune', event);"><code>ts-prune</code></a> to find dead code and dead types in your projects. <code>ts-prune</code> worked well enough, but it&#39;s now in maintenance mode and won&#39;t be receiving updates. This is a fine decision and it&#39;s the responsible thing to do when you no longer plan to maintain an open source project (I sometimes <a target="_blank" rel="noopener" href="https://github.com/danvk/dygraphs/issues/727" onclick="return trackOutboundLink('recommendation update  use knip to detect dead code and types', 'https://github.com/danvk/dygraphs/issues/727', event);">struggle</a> with this!).</p>
<p>While <code>ts-prune</code> was effective at its core job, it always had a few shortcomings: it couldn&#39;t detect <a target="_blank" rel="noopener" href="https://github.com/nadeesha/ts-prune/issues/96" onclick="return trackOutboundLink('recommendation update  use knip to detect dead code and types', 'https://github.com/nadeesha/ts-prune/issues/96', event);">unused dependencies</a> or <a target="_blank" rel="noopener" href="https://github.com/nadeesha/ts-prune/issues/97" onclick="return trackOutboundLink('recommendation update  use knip to detect dead code and types', 'https://github.com/nadeesha/ts-prune/issues/97', event);">mutually recursive dead code</a>. It also made no attempts to understand whether your test code was alive or dead. So when I noticed that <a target="_blank" rel="noopener" href="https://www.joshuakgoldberg.com/" onclick="return trackOutboundLink('recommendation update  use knip to detect dead code and types', 'https://www.joshuakgoldberg.com/', event);">Josh&#39;s</a> <a target="_blank" rel="noopener" href="https://github.com/JoshuaKGoldberg/template-typescript-node-package" onclick="return trackOutboundLink('recommendation update  use knip to detect dead code and types', 'https://github.com/JoshuaKGoldberg/template-typescript-node-package', event);">template-typescript-node-package</a> was using a new tool called <a target="_blank" rel="noopener" href="https://github.com/webpro/knip" onclick="return trackOutboundLink('recommendation update  use knip to detect dead code and types', 'https://github.com/webpro/knip', event);">Knip</a>, I was intrigued. Could this be the dead code removal tool of my dreams?</p>
<p>Basically, yes! <code>knip</code> uses the same sort of mark-and-sweep algorithm as <code>ts-prune</code> to find dead code (see my <a href="https://effectivetypescript.com/2020/10/20/tsprune/">previous post</a> for why this is what you want). But it&#39;s much more ambitious in the sorts of issues it tries to find:</p>
<ul>
<li>It will report unused <code>dependencies</code> and even <code>devDependencies</code> from your <code>package.json</code>. Removing these can be a huge win since it reduces your package size and eases the burden of keeping up to date with the latest versions.</li>
<li>It will report files that are never imported by non-test code.</li>
<li>It will report missing dependencies. This can happen if you depend on <code>A</code> which depends on <code>B</code>. You import something from <code>B</code> and it works, but you didn&#39;t list it in your dependencies. If you ever remove the dependency on <code>A</code>, this will be a problem. Best to depend on <code>B</code> directly if you use it directly.</li>
<li>It will report duplicate exports.</li>
<li>It will report unused class members and enum members.</li>
</ul>
<p>Because of the enormous diversity of JS/TS libraries and tools, you&#39;d expect that explaining your project setup to a tool like <code>knip</code> would involve writing a complicated configuration file. But that&#39;s usually not the case. knip&#39;s models this enormous diversity with an enormous collection of <a target="_blank" rel="noopener" href="https://github.com/webpro/knip#plugins" onclick="return trackOutboundLink('recommendation update  use knip to detect dead code and types', 'https://github.com/webpro/knip#plugins', event);">plugins</a>. Chances are that your test runner and framework are already on the list.</p>
<p>Give <code>knip</code> a try! You might be surprised at the dead code you&#39;ve accumulated. You can use <a target="_blank" rel="noopener" href="https://github.com/refstudio/refstudio/pull/225" onclick="return trackOutboundLink('recommendation update  use knip to detect dead code and types', 'https://github.com/refstudio/refstudio/pull/225', event);">this PR</a> as a template for setting it up in a project. Once you get down to zero errors, add <code>knip</code> to your CI to ensure that you never have dead code again!</p>

          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="follow-or-subscribe">
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          Like this post? Consider subscribing to
          <a href="/mail/" onclick="return trackOutboundLink('subscribe newsletter', '/mail/', event);">my newsletter</a>,
          the <a href="/atom.xml" onclick="return trackOutboundLink('follow RSS', '/atom.xml', event);">RSS feed</a>,
          or <a target="_blank" rel="noopener" href="https://twitter.com/danvdk" onclick="return trackOutboundLink('follow on twitter', 'https://twitter.com/danvdk', event);">following me</a>
          on Twitter.
        </div>
      </div>
    </div>
  </div>

  <div class="comments">
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <script src="https://utteranc.es/client.js" repo="danvk/effective-typescript" issue-term="title" label="💬 blog comments" theme="github-light" crossorigin="anonymous" async>
          </script>
        </div>
      </div>
    </div>
  </div>

  <div class="promotion">
    <div class="row">
      <div class="col-sm-12 text-center">
        <a target="_blank" rel="noopener" href="https://amzn.to/3UjPrsK" class="btn btn-info btn-lg primary" onclick="return trackOutboundLink('preorder', 'https://amzn.to/3UjPrsK', event);">Pre-order 2nd Ed.</a>
        <!--
          <a target="_blank" rel="noopener" href="https://amzn.to/3HIrQN6" data-tag="post learn more hover" class="btn btn-info btn-lg primary">Buy the Book</a>
          <a target="_blank" rel="noopener" href="https://www.ebooks.com/en-us/209820951/effective-typescript/dan-vanderkam/?_c=1" data-tag="post learn more hover" class="btn btn-info btn-lg hidden-xs">Buy eBook</a>
          https://amzn.to/3UjPrsK
        -->
        <a href="/mail/" class="btn btn-info btn-lg" onclick="return trackOutboundLink('post learn more hover', '/mail/', event);">Subscribe</a>
      </div>
    </div>
  </div>

  <div class="page-content">
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <a target="_blank" rel="noopener" href="https://amzn.to/3HIrQN6" onclick="return trackOutboundLink('post learn more cover image', 'https://amzn.to/3HIrQN6', event);">
            <img src="/images/cover-2e.jpg" class="learn-more-photo" alt="Effective TypeScript Book Cover">
          </a>
          <p><strong><em>Effective TypeScript</em></strong> shows you not just <em>how</em> to use TypeScript but how to use it <em>well</em>. The book&#39;s 62 items help you build mental models of how TypeScript and its ecosystem work, make you aware of pitfalls and traps to avoid, and guide you toward using TypeScript’s many capabilities in the most effective ways possible. Regardless of your level of TypeScript experience, you can learn something from this book.</p>
<p>After reading <em>Effective TypeScript</em>, your relationship with the type system will be the most productive it&#39;s ever been! <a href="/">Learn more »</a></p>

        </div>
      </div>
    </div>
  </div>

</section>

  <footer id="contentinfo" class="footer">
  <div class="container">
    <address id="about" class="vcard body">
      &copy; 2019 - 2024 <a class="url fn" target="_blank" rel="noopener" href="https://danvk.org" onclick="trackOutboundLink('footer', 'https://danvk.org'); return false;">Dan Vanderkam</a>
      <div class="footer-attribution">Powered by <a href="https://hexo.io/" target="_blank" onclick="return trackOutboundLink('recommendation update  use knip to detect dead code and types', 'https://hexo.io/', event);">Hexo</a></div>
    </address>
  </div>
</footer>
</body>
</html>
