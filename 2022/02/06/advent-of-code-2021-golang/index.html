<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    
    <title>A TypeScript Perspective on Go: the 2021 Advent of Code</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Khula:wght@600&family=Open+Sans:ital,wght@0,300;0,400;0,600;1,300;1,400;1,600&display=swap" rel="stylesheet">
    <link href="/css/customize.css" rel="stylesheet">
    <link href="/css/highlight.vs.css" rel="stylesheet">
    <link rel="icon" type="image/png" href="/images/icon.png">
    <meta name="description" content="Effective TypeScript: A TypeScript Perspective on Go: the 2021 Advent of Code">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:creator" content="@danvdk">
    <meta name="twitter:domain" content="effectivetypescript.com">
    <meta name="twitter:title" content="Effective TypeScript &rsaquo; A TypeScript Perspective on Go: the 2021 Advent of Code">
    <meta name="twitter:description" content="It&amp;#39;ll surprise no one to hear that TypeScript is my favorite programming language. But I do still enjoy dabbling in other languages. It&amp;#39;s a great way to get perspective on what makes TypeScript unique, and how other language designers are thinking about the same problems.
My favorite way to learn a new language is through the annual Advent of Code (AoC). AoC runs every year from Dec 1-25. Every day unlocks a new puzzle with two parts which build on each other. Lots of people do these puzzles (over 100,000 completed day 1 this year) and post their solutions on r/adventofcode. In 2019 I did it in Python (not a new language for me) and in 2020 I did it in Rust (which was a new language). This year, I did it in Go (aka Golang).
This post has three parts:

My impressions of Go (coming from a TypeScript perspective)
My impressions of this year&amp;#39;s Advent of Code
Notes and links for each day
">
    <meta name="twitter:img:src" content="https://effectivetypescript.com/images/cover.jpg">

    <meta property="og:title" content="Effective TypeScript &rsaquo; A TypeScript Perspective on Go: the 2021 Advent of Code">
    <meta property="og:description" content="It&amp;#39;ll surprise no one to hear that TypeScript is my favorite programming language. But I do still enjoy dabbling in other languages. It&amp;#39;s a great way to get perspective on what makes TypeScript unique, and how other language designers are thinking about the same problems.
My favorite way to learn a new language is through the annual Advent of Code (AoC). AoC runs every year from Dec 1-25. Every day unlocks a new puzzle with two parts which build on each other. Lots of people do these puzzles (over 100,000 completed day 1 this year) and post their solutions on r/adventofcode. In 2019 I did it in Python (not a new language for me) and in 2020 I did it in Rust (which was a new language). This year, I did it in Go (aka Golang).
This post has three parts:

My impressions of Go (coming from a TypeScript perspective)
My impressions of this year&amp;#39;s Advent of Code
Notes and links for each day
">
    <meta property="og:image" content="https://effectivetypescript.com/images/cover.jpg">
    <meta property="og:url" content="https://effectivetypescript.com/">

    <link href="https://effectivetypescript.com/atom.xml" type="application/atom+xml" rel="alternate" title="Effective TypeScript Atom Feed">

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-769809-4"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-769809-4');

      var trackOutboundLink = function(category, url, e) {
        if (!window.google_tag_manager) {
          console.log('blocked!');
          return true;  // probably blocked
        }

        // No need to use event_callback if the link is opening in a new tab.
        var newTab = e && (e.metaKey || (e.currentTarget && e.currentTarget.target === '_blank'));
        gtag('event', 'click', {
            'event_category': category,
            'event_label': url,
            'transport_type': 'beacon',
            'event_callback': !newTab ? function() {
              document.location = url;
            } : undefined
        });

        return newTab;
      }
    </script>
  <meta name="generator" content="Hexo 5.4.0"></head>

<body class="post">
  <div class="header">
  <div class="container">
      <div class="row">
          <div class="col-md-12">
              <h1 class="site-title">
                  <a href="/">
                      Effective TypeScript
                  </a>
              </h1>
          </div>
      </div>
  </div>
</div>

  <section id="content" class="article content">

  <div class="title-bar">
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <h2>A TypeScript Perspective on Go: the 2021 Advent of Code</h2>
        </div>
      </div>
    </div>
  </div>

  <div class="page-content">
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <div class="text-muted published-container">
            <time class="published" datetime="2022-02-06T23:00:00.000Z" itemprop="datePublished">
              Sun 06 February 2022
            </time>
          </div>
          <div class="entry-content">
            <p><img src="https://effectivetypescript.com/images/advent-of-code.png" title="Advent of Code Logo" width="64" height="64" style="float: right; margin-left: 10px;">It&#39;ll surprise no one to hear that TypeScript is my favorite programming language. But I do still enjoy dabbling in other languages. It&#39;s a great way to get perspective on what makes TypeScript unique, and how other language designers are thinking about the same problems.</p>
<p>My favorite way to learn a new language is through the annual <a target="_blank" rel="noopener" href="https://adventofcode.com" onclick="return trackOutboundLink('a typescript perspective on go the  advent of code', 'https://adventofcode.com', event);">Advent of Code</a> (AoC). AoC runs every year from Dec 1-25. Every day unlocks a new puzzle with two parts which build on each other. Lots of people do these puzzles (over 100,000 completed day 1 this year) and post their solutions on <a target="_blank" rel="noopener" href="https://reddit.com/r/adventofcode" onclick="return trackOutboundLink('a typescript perspective on go the  advent of code', 'https://reddit.com/r/adventofcode', event);">r/adventofcode</a>. In 2019 I <a target="_blank" rel="noopener" href="https://danvdk.medium.com/python-tips-tricks-for-the-advent-of-code-2019-89ec23a595dd" onclick="return trackOutboundLink('a typescript perspective on go the  advent of code', 'https://danvdk.medium.com/python-tips-tricks-for-the-advent-of-code-2019-89ec23a595dd', event);">did it in Python</a> (not a new language for me) and in 2020 I <a href="https://effectivetypescript.com/2021/03/24/advent-of-code/">did it in Rust</a> (which was a new language). This year, I did it in Go (aka Golang).</p>
<p>This post has three parts:</p>
<ul>
<li>My impressions of Go (coming from a TypeScript perspective)</li>
<li>My impressions of this year&#39;s Advent of Code</li>
<li>Notes and links for each day</li>
</ul>
<span id="more"></span>

<h2 id="My-Impressions-of-Go"><a href="#My-Impressions-of-Go" class="headerlink" title="My Impressions of Go"></a>My Impressions of Go</h2><p>I first used Go when I was working at Google in 2011. C++ was my main language at the time, so Go wasn&#39;t such a big shift. I remember finding it quite confusing until I really &quot;got&quot; the idea of duck typing: the consumer of an interface defines what it needs and the producer doesn&#39;t need to declare that it implements this interface. I didn&#39;t have much use for Go in my work or personal projects, so I mostly forgot about it.</p>
<p>Some parts of Go&#39;s design that seemed strange in 2011 have aged quite well: automatic formatting of source code is very standard now, and I certainly didn&#39;t mind Go complaining about unused symbols. One thing that I found confusing in 2011 and still found confusing today: Go&#39;s insistence on where you put your source code on disk. I usually put all my GitHub repos in <code>~/github/reponame</code>. But Go wants them under <code>$GOROOT</code>, which is <code>~/go</code> (or <code>~/gotip</code>) on my system. This made my setup experience a bit frustrating, but once I gave up and put my code in <code>$GOROOT</code> everything worked OK and I moved on.</p>
<p>Last year my pattern was to solve the puzzle, then look at how more experienced Rust developers solved it on <a target="_blank" rel="noopener" href="https://reddit.com/r/adventofcode" onclick="return trackOutboundLink('my impressions of go', 'https://reddit.com/r/adventofcode', event);">r/adventofcode</a>. I almost invariably learned something from this. That didn&#39;t work this year. In Go, the straightforward approach is usually the canonical one. There are just fewer surprises. Go takes pride in being a <a target="_blank" rel="noopener" href="https://www.capitalone.com/tech/software-engineering/go-is-boring/" onclick="return trackOutboundLink('my impressions of go', 'https://www.capitalone.com/tech/software-engineering/go-is-boring/', event);">&quot;boring&quot; language</a>. I learned more about Go from having <a target="_blank" rel="noopener" href="https://github.com/danvk/aoc2021/commit/a3b38546680c52e1c9c29365a712c834214082cf#r62160234" onclick="return trackOutboundLink('my impressions of go', 'https://github.com/danvk/aoc2021/commit/a3b38546680c52e1c9c29365a712c834214082cf#r62160234', event);">@derat review my code</a> and make more specific suggestions.</p>
<p>I&#39;m aware that the Advent of Code doesn&#39;t particularly play to Go&#39;s strengths: there&#39;s no concurrency, for example. But I still found it to be a good way to force myself to learn the basics of the language and use it to solve real problems.</p>
<p>Here are a few differences between Go and TypeScript that stood out to me.</p>
<h3 id="Implicit-copies"><a href="#Implicit-copies" class="headerlink" title="Implicit copies"></a>Implicit copies</h3><p>I&#39;m not aware of any situation in which JavaScript makes a copy of an object without your asking it to. In Go, however, this happens all the time. Building a mental model for when these copies happens is always relevant for performance, and sometimes relevant for correctness.</p>
<p>In TypeScript, we can create a <code>Student</code> type with a name and age, and <a target="_blank" rel="noopener" href="https://www.typescriptlang.org/play?#code/JYOwLgpgTgZghgYwgAgMpgK4BMLmQbwFgAoZZEOAWwgC5kBnMKUAcwG4Sy4XbyNKARtA7EAviRIwMIBGGAB7EMgCCPZQE0IcKAAp6ddNlxgAlAU4MAdNxQBqALzIAjCXHESCRY2QD5AgQCeBpg4eI745FS8AOQAQn6B0QA0yDZ0TgBMyKIiqhAaWrq+-gEmIp4g9PIANhCW1fIsOsWB1jxlZAD0ncgACszg9M4AzCRAA" onclick="return trackOutboundLink('my impressions of go', 'https://www.typescriptlang.org/play?#code/JYOwLgpgTgZghgYwgAgMpgK4BMLmQbwFgAoZZEOAWwgC5kBnMKUAcwG4Sy4XbyNKARtA7EAviRIwMIBGGAB7EMgCCPZQE0IcKAAp6ddNlxgAlAU4MAdNxQBqALzIAjCXHESCRY2QD5AgQCeBpg4eI745FS8AOQAQn6B0QA0yDZ0TgBMyKIiqhAaWrq+-gEmIp4g9PIANhCW1fIsOsWB1jxlZAD0ncgACszg9M4AzCRAA', event);">write a function</a> to make a student age by a year:</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">interface</span> Student &#123;<br>  name: <span class="hljs-built_in">string</span>;<br>  age: <span class="hljs-built_in">number</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AgeAYear</span>(<span class="hljs-params">s: Student</span>) </span>&#123;<br>  s.age += <span class="hljs-number">1</span><br>&#125;<br><br><span class="hljs-keyword">const</span> bobby: Student = &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Bobby&#x27;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">12</span> &#125;;<br>AgeAYear(bobby);<br><span class="hljs-built_in">console</span>.log(bobby.age);  <span class="hljs-comment">// Prints 13</span><br></code></pre></td></tr></table></figure>

<p>In JavaScript, objects are always passed by reference. There&#39;s only one <code>Student</code> floating around and <code>AgeAYear</code> modifies it, which is why this code logs 13. (Are primitive types like <code>string</code> are passed by value or by reference? It&#39;s irrelevant because they&#39;re immutable.)</p>
<p>In Go, <a target="_blank" rel="noopener" href="https://go.dev/play/p/zhTqc1-SP1J" onclick="return trackOutboundLink('my impressions of go', 'https://go.dev/play/p/zhTqc1-SP1J', event);">something very different happens</a>:</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Student <span class="hljs-keyword">struct</span> &#123;<br>	name <span class="hljs-keyword">string</span><br>	age  <span class="hljs-keyword">int</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">AgeAYear</span><span class="hljs-params">(s Student)</span></span> &#123;<br>	s.age += <span class="hljs-number">1</span><br>	fmt.Printf(<span class="hljs-string">&quot;Age is %d\n&quot;</span>, s.age)  <span class="hljs-comment">// prints 13</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>	bobby := Student&#123;<span class="hljs-string">&quot;Bobby&quot;</span>, <span class="hljs-number">12</span>&#125;<br>	AgeAYear(bobby)<br>	fmt.Printf(<span class="hljs-string">&quot;Bobby&#x27;s age is %d\n&quot;</span>, bobby.age)  <span class="hljs-comment">// prints 12</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>Go passes objects by <em>value</em>, not by reference, so <code>AgeAYear</code> is actually operating on a <em>copy</em> of <code>bobby</code>, not the original. This copy&#39;s <code>age</code> increases, but then the copy gets thrown away when the function returns. C++ has a similar behavior and calls this &quot;value semantics.&quot;</p>
<p>If you want to mutate <code>bobby</code>, you can use a pointer instead:</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">GetOlder</span><span class="hljs-params">(s *Student)</span></span> &#123;<br>	s.age += <span class="hljs-number">1</span><br>	fmt.Printf(<span class="hljs-string">&quot;Age is %d\n&quot;</span>, s.age)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>	bob := Student&#123;<span class="hljs-string">&quot;Bobby&quot;</span>, <span class="hljs-number">12</span>&#125;<br>	GetOlder(&amp;bob)<br>	fmt.Printf(<span class="hljs-string">&quot;Bob&#x27;s age is %d\n&quot;</span>, bob.age)<br>&#125;<br></code></pre></td></tr></table></figure>

<p>Now this logs <code>13</code> twice. Working with pointers has some famous drawbacks, of course, but it&#39;s much easier in Go than it is in C or C++ because there&#39;s garbage collection.</p>
<p>Pointers in Go have a way of being contagious. Once you use a pointer to a structure in one place, you can get into trouble if you ever pass it by value someplace else. For example:</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> SelfReference <span class="hljs-keyword">struct</span> &#123;<br>  name <span class="hljs-keyword">string</span><br>  self *SelfReference<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">MakeSelfReference</span><span class="hljs-params">(name <span class="hljs-keyword">string</span>)</span> <span class="hljs-title">SelfReference</span></span> &#123;<br>  me := SelfReference &#123;name: name&#125;<br>  me.self = &amp;me<br>  fmt.Printf(<span class="hljs-string">&quot;References self? %v\n&quot;</span>, me.self == &amp;me)  <span class="hljs-comment">// true</span><br>  <span class="hljs-keyword">return</span> me<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>  me := MakeSelfReference(<span class="hljs-string">&quot;me&quot;</span>)<br>  fmt.Printf(<span class="hljs-string">&quot;References self?: %v\n&quot;</span>, me.self == &amp;me)  <span class="hljs-comment">// false</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://go.dev/play/p/wCiNfPlX75W" onclick="return trackOutboundLink('my impressions of go', 'https://go.dev/play/p/wCiNfPlX75W', event);">This code</a> logs:</p>
<pre><code>References self? true
References self? false</code></pre><p>I scratched my head a good long time over an issue like this before realizing that when <code>MakeSelfReference</code> <em>returns</em>, it makes a copy of the object but of course doesn&#39;t update the <code>self</code> pointer. So the two get out of sync. If you want to keep them in sync, you want to return a <code>*SelfReference</code> instead.</p>
<p>It took me some time to build an intuition for this because the rules about what&#39;s copied can be surprising. An array (which always has a fixed size in Go) is copied by value, but passing a slice (which is like a small struct with a pointer, length and cap) does not make a copy of the underlying array. Another wrinkle (which I won&#39;t dive into here) is that depending on how a method is declared, invoking it can implicitly copy the object, too.</p>
<p>All these implicit copies are important and eventually this became intuitive, but it&#39;s quite a shift if you&#39;re coming from JS!</p>
<h3 id="Batteries-not-included"><a href="#Batteries-not-included" class="headerlink" title="Batteries not included"></a>Batteries not included</h3><p>Go is definitely not a &quot;batteries included&quot; language: there are many very common and familiar functions that are missing from its standard library, notably <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/19239449/how-do-i-reverse-an-array-in-go/19239832" onclick="return trackOutboundLink('my impressions of go', 'https://stackoverflow.com/questions/19239449/how-do-i-reverse-an-array-in-go/19239832', event);">reversing a list</a>, the standard <code>map</code> / <code>filter</code> / <code>reduce</code> functions, taking the min/max of two numbers or <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/57648933/why-doesnt-go-have-a-function-to-calculate-the-absolute-value-of-integers" onclick="return trackOutboundLink('my impressions of go', 'https://stackoverflow.com/questions/57648933/why-doesnt-go-have-a-function-to-calculate-the-absolute-value-of-integers', event);">taking the absolute value of an integer</a>. The argument is that these functions are easy to write, so if you want them, you should just write them. But that does lead to some strange interactions. This VS Code shortcut is a real gem:</p>
<p><img src="https://effectivetypescript.com/images/golang-reverse.gif" alt="VS Code Reverse"></p>
<p>I guess this beats copy/pasting from Stack Overflow? My old coworker Dan suggested that this was a way to push you towards reverse iteration, which is faster and requires less memory than allocating a new list. The Go team tends to have very strong opinions about things like this. If you agree with them, then it&#39;s fun to watch them take a stand. But if you don&#39;t, you wind up having to settle for weird workarounds like this one.</p>
<p>The omission of <code>map</code> / <code>filter</code> / <code>reduce</code> is likely because these functions aren&#39;t that useful without generics. And there is some exciting news on that front!</p>
<h3 id="Generics"><a href="#Generics" class="headerlink" title="Generics"></a>Generics</h3><p>The Go team <a target="_blank" rel="noopener" href="https://go.googlesource.com/proposal/+/refs/heads/master/design/43651-type-parameters.md" onclick="return trackOutboundLink('my impressions of go', 'https://go.googlesource.com/proposal/+/refs/heads/master/design/43651-type-parameters.md', event);">accepted a propsal</a> to add generics to the language in mid-2021 and the Go 1.18 beta, which included support for them, came out in the middle of this year&#39;s AoC. Generics are a big part of TypeScript, so I was curious to see Go&#39;s take on them. I did most of the puzzles using <a target="_blank" rel="noopener" href="https://pkg.go.dev/golang.org/dl/gotip" onclick="return trackOutboundLink('my impressions of go', 'https://pkg.go.dev/golang.org/dl/gotip', event);">gotip</a> so that I could use generics before they were officially released. Overall this was a pretty smooth process. I found that Go with Generics is a much more pleasant language to use than Go without.</p>
<p>Here&#39;s what a <a target="_blank" rel="noopener" href="https://github.com/danvk/aoc2021/blob/ba0936c804ff9c2a170472c77de029712baa069f/util/util.go#L159-L170" onclick="return trackOutboundLink('my impressions of go', 'https://github.com/danvk/aoc2021/blob/ba0936c804ff9c2a170472c77de029712baa069f/util/util.go#L159-L170', event);">generic <code>min</code> function</a> looks like in Go:</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;constraints&quot;</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Min</span>[<span class="hljs-title">T</span> <span class="hljs-title">constraints</span>.<span class="hljs-title">Ordered</span>]<span class="hljs-params">(nums []T)</span> <span class="hljs-title">T</span></span> &#123;<br>	<span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(nums) == <span class="hljs-number">0</span> &#123;<br>		<span class="hljs-built_in">panic</span>(nums)<br>	&#125;<br>	min := nums[<span class="hljs-number">0</span>]<br>	<span class="hljs-keyword">for</span> _, v := <span class="hljs-keyword">range</span> nums[<span class="hljs-number">1</span>:] &#123;<br>		<span class="hljs-keyword">if</span> v &lt; min &#123;<br>			min = v<br>		&#125;<br>	&#125;<br>	<span class="hljs-keyword">return</span> min<br>&#125;<br></code></pre></td></tr></table></figure>

<p>Aside from some syntax differences, this is quite similar to how you&#39;d <a target="_blank" rel="noopener" href="https://www.typescriptlang.org/play?#code/GYVwdgxgLglg9mABAWRmAPAFQHwAoBuAhgDYDOAXIpgNoC6AlJZogN4CwAUIojMIgSVIA6YgFMwAcygALRAF4FiAAz1WnbtxkAnOAHdEYUfoCiWnVtwByAMKEwYOFERRCAa1GIAtmkRw+ozwAHKABPRGIYUihLegBudUQAXwSxJ28kOUQiMmolWniuRGA4LX4IBCis3z5s4VIIiFFcAEZ6VXZC7l5+fER0LzR2hI0BjKyCkeTCqe4tUSgQLSR0gsSgA" onclick="return trackOutboundLink('my impressions of go', 'https://www.typescriptlang.org/play?#code/GYVwdgxgLglg9mABAWRmAPAFQHwAoBuAhgDYDOAXIpgNoC6AlJZogN4CwAUIojMIgSVIA6YgFMwAcygALRAF4FiAAz1WnbtxkAnOAHdEYUfoCiWnVtwByAMKEwYOFERRCAa1GIAtmkRw+ozwAHKABPRGIYUihLegBudUQAXwSxJ28kOUQiMmolWniuRGA4LX4IBCis3z5s4VIIiFFcAEZ6VXZC7l5+fER0LzR2hI0BjKyCkeTCqe4tUSgQLSR0gsSgA', event);">write this code</a> in TypeScript:</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><code class="hljs ts"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Min</span>&lt;<span class="hljs-title">T</span>&gt;(<span class="hljs-params">vals: T[]</span>): <span class="hljs-title">T</span> </span>&#123;<br>  <span class="hljs-keyword">if</span> (vals.length === <span class="hljs-number">0</span>) &#123;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&#x27;Cannot take min of empty list&#x27;</span>);<br>  &#125;<br>  <span class="hljs-keyword">let</span> min = vals[<span class="hljs-number">0</span>];<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> v <span class="hljs-keyword">of</span> vals.slice(<span class="hljs-number">1</span>)) &#123;<br>    <span class="hljs-keyword">if</span> (v &lt; min) &#123;<br>      min = v;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> min;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>The most interesting bit in the Go code is the <code>[T constraints.Ordered]</code>, which would be similar to <code>T extends Ordered</code> in TypeScript. Go comes with a <code>constraints.go</code> module that <a target="_blank" rel="noopener" href="https://cs.opensource.google/go/go/+/master:src/constraints/constraints.go;l=44-50?q=constraints.go&ss=go%2Fgo" onclick="return trackOutboundLink('my impressions of go', 'https://cs.opensource.google/go/go/+/master:src/constraints/constraints.go;l=44-50?q=constraints.go&ss=go%2Fgo', event);">defines <code>Ordered</code></a> and many other constraints that can be placed on type parameters:</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// Ordered is a constraint that permits any ordered type: any type</span><br><span class="hljs-comment">// that supports the operators &lt; &lt;= &gt;= &gt;.</span><br><span class="hljs-comment">// If future releases of Go add new ordered types,</span><br><span class="hljs-comment">// this constraint will be modified to include them.</span><br><span class="hljs-keyword">type</span> Ordered <span class="hljs-keyword">interface</span> &#123;<br>	Integer | Float | ~<span class="hljs-keyword">string</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>Both <code>Integer</code> and <code>Float</code> are themselves constraints (while JS/TS just has <code>number</code>, there are many numeric types in Go such as <code>uint32</code> or <code>float64</code>). The tilde in <code>~string</code> is also interesting. It matches any type whose &quot;underlying type&quot; is <code>string</code>. This confused me for a while until I realized that, unlike TypeScript, Go has nominal types! For example:</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> EnglishWord <span class="hljs-keyword">string</span><br><span class="hljs-keyword">type</span> GermanWord <span class="hljs-keyword">string</span><br></code></pre></td></tr></table></figure>

<p>This would create two types that are not comparable or assignable to one another. But you can certainly take the min or max of a list of <code>EnglishWord</code>s. This is a feature that has been <a target="_blank" rel="noopener" href="https://github.com/Microsoft/Typescript/issues/202" onclick="return trackOutboundLink('my impressions of go', 'https://github.com/Microsoft/Typescript/issues/202', event);">much discussed</a> in TypeScript but is not natively supported. I found nominal types less useful in the Advent of Code than I would have expected. (I only used them to create distinct types for <code>Digit</code> and <code>ScrambledDigit</code> on <a target="_blank" rel="noopener" href="https://github.com/danvk/aoc2021#day-8-seven-segment-search-33759--24434" onclick="return trackOutboundLink('my impressions of go', 'https://github.com/danvk/aoc2021#day-8-seven-segment-search-33759--24434', event);">Day 8</a>).</p>
<p>So is the Go generic code equivalent to this TypeScript?</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">type</span> Orderable = <span class="hljs-built_in">string</span> | <span class="hljs-built_in">number</span>;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Min</span>&lt;<span class="hljs-title">T</span> <span class="hljs-title">extends</span> <span class="hljs-title">Orderable</span>&gt;(<span class="hljs-params">vals: T[]</span>): <span class="hljs-title">T</span> </span>&#123; ... &#125;<br></code></pre></td></tr></table></figure>

<p>Not quite. This TypeScript definition would allow you to take the min of a mixed list of <code>string</code>s and <code>number</code>s, which should be an error:</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> mixedList = [<span class="hljs-number">42</span>, <span class="hljs-string">&#x27;forty two&#x27;</span>];  <span class="hljs-comment">// type is (string | number)[]</span><br><span class="hljs-keyword">const</span> min = Min(mixedList);  <span class="hljs-comment">// T is string|number, returns a string|number</span><br></code></pre></td></tr></table></figure>

<p>There&#39;s no notion of a union type in Go (more on that in a moment), so <code>T</code> has to be exactly one of the types enumerated in the constraint (or a type with exactly one of those underlying types).</p>
<p>I found Go generics to mostly work as expected and be quite intuitive. They let me factor out some of the repetitive boilerplate that bothered me when I first started with the language.</p>
<p>For example, this is a very common pattern to map a function over a slice:</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go">nums := []<span class="hljs-keyword">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>&#125;<br><span class="hljs-keyword">var</span> squares []<span class="hljs-keyword">int</span><br><span class="hljs-keyword">for</span> _, num := <span class="hljs-keyword">range</span> nums &#123;<br>  squares = <span class="hljs-built_in">append</span>(squares, num * num)<br>&#125;<br></code></pre></td></tr></table></figure>

<p>With generics, you can factor out a <code>Map</code> function and <a target="_blank" rel="noopener" href="https://go.dev/play/p/boWkZFquqck?v=gotip" onclick="return trackOutboundLink('my impressions of go', 'https://go.dev/play/p/boWkZFquqck?v=gotip', event);">rewrite this loop</a>:</p>
<figure class="highlight go"><table><tr><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Map</span>[<span class="hljs-title">T</span> <span class="hljs-title">any</span>, <span class="hljs-title">U</span> <span class="hljs-title">any</span>]<span class="hljs-params">(vals []T, fn <span class="hljs-keyword">func</span>(T)</span> <span class="hljs-title">U</span>) []<span class="hljs-title">U</span></span> &#123;<br>	<span class="hljs-keyword">var</span> us []U<br>	<span class="hljs-keyword">for</span> _, v := <span class="hljs-keyword">range</span> vals &#123;<br>		us = <span class="hljs-built_in">append</span>(us, fn(v))<br>	&#125;<br>	<span class="hljs-keyword">return</span> us<br>&#125;<br><br>squares := Map(nums, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(num <span class="hljs-keyword">int</span>)</span> <span class="hljs-title">int</span></span> &#123; <span class="hljs-keyword">return</span> num * num &#125;)<br></code></pre></td></tr></table></figure>

<p>This is quite verbose compared to how it would look in TypeScript:</p>
<figure class="highlight ts"><table><tr><td class="code"><pre><code class="hljs ts">squares = nums.map(<span class="hljs-function"><span class="hljs-params">num</span> =&gt;</span> num * num);<br></code></pre></td></tr></table></figure>

<p>The TypeScript version is so much shorter because:</p>
<ol>
<li>JavaScript&#39;s <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions" onclick="return trackOutboundLink('my impressions of go', 'https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions', event);">arrow functions</a> have a very compact syntax compared to Go&#39;s <code>func</code> and <code>return</code>.</li>
<li>TypeScript is able to infer two types: both a) the type of the function parameter (<code>num</code>), which it gets from the type of <code>nums</code> and the type of <code>Array.prototype.map</code>, and b) the return type of the arrow function, which it gets from the function body (<code>num * num</code>). Go infers neither of these, so you have to write out the types. It does infer the return type of the whole <code>Map</code> expression, though (<code>[]int</code>).</li>
</ol>
<p>I expect that having generics will greatly increase the demand for concise function definitions and better type inference. The Go team will either adopt them or declare that the users asking for them are misguided. It&#39;ll almost certainly be one of those two â€” they&#39;re quite opinionated!</p>
<p>There&#39;s a <a target="_blank" rel="noopener" href="https://research.swtch.com/generic" onclick="return trackOutboundLink('my impressions of go', 'https://research.swtch.com/generic', event);">famous quote</a> from one of the Go developers (Russ Cox) that when it comes to generics, you can either have:</p>
<ol>
<li>Slow programmers (i.e. no generics)</li>
<li>Slow compilers (by emitting a different version of a generic function for every type instantiation)</li>
<li>Slow programs (by boxing everything and doing runtime dispatch).</li>
</ol>
<p>In this scheme, JavaScript forces TypeScript to choose &quot;slow programs&quot; (though JS JITs are quite good!). And TypeScript has a complex enough type system that it&#39;s often a slow compiler, even without C++-style compile-time specialization.</p>
<p>Go tries to <a target="_blank" rel="noopener" href="https://go.googlesource.com/proposal/+/refs/heads/master/design/43651-type-parameters.md#implementation" onclick="return trackOutboundLink('my impressions of go', 'https://go.googlesource.com/proposal/+/refs/heads/master/design/43651-type-parameters.md#implementation', event);">escape this dilemma</a> by leaving it up to the compiler whether to specialize a function or box it. The whole <a target="_blank" rel="noopener" href="https://go.googlesource.com/proposal/+/refs/heads/master/design/43651-type-parameters.md" onclick="return trackOutboundLink('my impressions of go', 'https://go.googlesource.com/proposal/+/refs/heads/master/design/43651-type-parameters.md', event);">generics proposal</a> is interesting to read. It only occurred to me halfway through the doc that runtime performance was a consideration. Clearly I&#39;ve internalized the TypeScript approach to generics!</p>
<p>Overall I found Go generics easy to use and a great addition to the language. It will be interesting to see how they&#39;re adopted by the community, and whether they bifurcate libraries. I wanted a Graph library, for example, but there weren&#39;t any that used generics. So I just <a target="_blank" rel="noopener" href="https://github.com/danvk/aoc2021/blob/master/graph/graph.go" onclick="return trackOutboundLink('my impressions of go', 'https://github.com/danvk/aoc2021/blob/master/graph/graph.go', event);">wrote my own</a>.</p>
<h3 id="Other-bits"><a href="#Other-bits" class="headerlink" title="Other bits"></a>Other bits</h3><p>Here are a few other things I found interesting about Go:</p>
<ul>
<li><p>Go has some extremely error-prone constructs. Two examples:</p>
<ul>
<li>You write a for loop over a slice as <code>for idx, el := range vals</code>. So <code>range</code> gives you the index first and then the value. This means that if you write <code>for el := range vals</code>, you&#39;ll iterate over the indices, not the values. I much prefer the JS approach of value then index, e.g. for <code>map</code> and <code>forEach</code>. It seems much more common to only care about the value than to only care about the index.</li>
<li>Does <code>a, b := fn()</code> introduce two new variables? It depends. If both <code>a</code> and <code>b</code> exist, then it will create two new variables. But if only <code>a</code> exists, then it will create a new <code>a</code> variable but reassign <code>b</code>. I found this quite surprising!</li>
</ul>
</li>
<li><p>I really missed union types. Go has <a target="_blank" rel="noopener" href="https://making.pusher.com/alternatives-to-sum-types-in-go/" onclick="return trackOutboundLink('my impressions of go', 'https://making.pusher.com/alternatives-to-sum-types-in-go/', event);">nothing like them</a>, and the official stance from the Go team is that they <a target="_blank" rel="noopener" href="https://github.com/golang/go/issues/19412#issuecomment-284301017" onclick="return trackOutboundLink('my impressions of go', 'https://github.com/golang/go/issues/19412#issuecomment-284301017', event);">&quot;do not add very much&quot;</a> to untyped solutions. ðŸ¤® Remember what I said about the Go team being opinionated?</p>
</li>
<li><p>You don&#39;t need regular expressions as much as you think for parsing. <code>fmt.Sscanf</code> woked great for most of the Advent of Code problems.</p>
</li>
<li><p>Like TS, Go has both <code>var</code> and <code>const</code> but <a target="_blank" rel="noopener" href="https://go.dev/ref/spec#Package_initialization" onclick="return trackOutboundLink('my impressions of go', 'https://go.dev/ref/spec#Package_initialization', event);">they mean pretty different things</a>.</p>
</li>
<li><p>Go doesn&#39;t really have a C++-like notion of <code>const</code> or TypeScript&#39;s <code>readonly</code>.</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://danvdk.medium.com/python-tips-tricks-for-the-advent-of-code-2019-89ec23a595dd#9719" onclick="return trackOutboundLink('my impressions of go', 'https://danvdk.medium.com/python-tips-tricks-for-the-advent-of-code-2019-89ec23a595dd#9719', event);">As in other years</a>, I found that using <code>map[Coord]T</code> instead of <code>[][]T</code> is almost always a good idea. It lets you create sparse arrays and accomodates unknown size or negative indices.</p>
</li>
<li><p>Go&#39;s type syntax is almost exactly backwards from TypeScript or C, which was a constant source of typos for me. For example, <code>[]T</code> instead of <code>T[]</code>. Or for function parameters, <code>min(a int, b int)</code> instead of <code>min(int a, int b)</code>. Or even <code>min(a, b int)</code>.</p>
</li>
<li><p>I still find Go&#39;s pickiness about where I put my code on disk to be weird, confusing and counterproductive. Why can&#39;t I <code>go build</code> something in a subdirectory?</p>
</li>
<li><p>Go types all have a meaningful zero value. I started to learn to work with this more and more as the month went on. For example, <code>nil</code> works perfectly well as an empty slice.</p>
</li>
<li><p>I&#39;ve always been a spaces person but Go uses tabs. It didn&#39;t bother me one bit.</p>
</li>
</ul>
<h2 id="My-impressions-of-this-year-39-s-Advent-of-Code"><a href="#My-impressions-of-this-year-39-s-Advent-of-Code" class="headerlink" title="My impressions of this year&#39;s Advent of Code"></a>My impressions of this year&#39;s Advent of Code</h2><p>The 2021 AoC was harder than 2020 but easier than 2019. As in 2020, none of the solutions built on one another. Each day was a completely independent puzzle. I&#39;m sure <a target="_blank" rel="noopener" href="http://was.tl/" onclick="return trackOutboundLink('my impressions of this years advent of code', 'http://was.tl/', event);">Eric Wastl</a> has his reasons for doing it this way, but I missed how 2019&#39;s puzzles encouraged you to improve the design of your previous day&#39;s solutions. With the independent puzzles, Advent of Code feels more like pure speed coding.</p>
<p>Days 8, 22 and 24 were the real standouts to me as a creative puzzles. For the other days, my first idea on how to solve the puzzle always turned out to be right, even if it took quite a while to implement it. Many, many of the puzzles this year could be solved with some variation on <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Dijkstra%27s_algorithm" onclick="return trackOutboundLink('my impressions of this years advent of code', 'https://en.wikipedia.org/wiki/Dijkstra%27s_algorithm', event);">Dijkstra</a>. It&#39;s always amazing to see how effective the standard algorithms are once you figure out how to map your problem onto them.</p>
<p>I continue to wish I were in a timezone where it was more reasonable for me to do the puzzles as soon as they came out. And I continue to think this is a great way to learn a language. AoC problems don&#39;t really play to Go&#39;s strengths (there&#39;s no concurrency) but I did feel much more confident writing Go by the end than I did at the start.</p>
<h2 id="Conclusions"><a href="#Conclusions" class="headerlink" title="Conclusions"></a>Conclusions</h2><p>Once again, I had a great time doing Advent of Code this year and I enjoyed the opportunity to learn a new language. The days&#39; puzzles gave me something concrete and fun to cling to during a time of <a target="_blank" rel="noopener" href="https://www.theverge.com/2021/12/16/22840028/sidewalk-labs-google-doctoroff-health-toronto-quayside" onclick="return trackOutboundLink('conclusions', 'https://www.theverge.com/2021/12/16/22840028/sidewalk-labs-google-doctoroff-health-toronto-quayside', event);">complete chaos</a> at my work.</p>
<p>Day 25 in particular stands out. I woke up early (6 AM) to watch the long-anticipated <a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=9tXlqWldVVk" onclick="return trackOutboundLink('conclusions', 'https://www.youtube.com/watch?v=9tXlqWldVVk', event);">launch of the James Webb Space Telescope</a>, and I raced to collect my final stars before I had to drive off to the airport for a trip to the Dominican Republic, my first international vacation in ~2.5 years.</p>
<p>It&#39;s unlikely I&#39;ll use Go in my daily work, but I do enjoy the perspective on TypeScript that it gives. As always, TypeScript&#39;s relationship to JavaScript (types are erased at runtime) and its ability to infer types stand out. Which language will I try next year? I&#39;m not sure! Suggestions welcome.</p>
<p>If you&#39;ve made it this far and for some reason want even more, check out the <a target="_blank" rel="noopener" href="https://github.com/danvk/aoc2021" onclick="return trackOutboundLink('conclusions', 'https://github.com/danvk/aoc2021', event);">notes and code</a> in my GitHub repo.</p>

          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="follow-or-subscribe">
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          Like this post? Consider subscribing to
          <a href="/mail/" onclick="return trackOutboundLink('subscribe newsletter', '/mail/', event);">my newsletter</a>,
          the <a href="/atom.xml" onclick="return trackOutboundLink('follow RSS', '/atom.xml', event);">RSS feed</a>,
          or <a target="_blank" rel="noopener" href="https://twitter.com/danvdk" onclick="return trackOutboundLink('follow on twitter', 'https://twitter.com/danvdk', event);">following me</a>
          on Twitter.
        </div>
      </div>
    </div>
  </div>

  <div class="comments">
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <script src="https://utteranc.es/client.js" repo="danvk/effective-typescript" issue-term="title" label="ðŸ’¬ blog comments" theme="github-light" crossorigin="anonymous" async>
          </script>
        </div>
      </div>
    </div>
  </div>

  <div class="promotion">
    <div class="row">
      <div class="col-sm-12 text-center">
        <a target="_blank" rel="noopener" href="https://amzn.to/38s1oCK" class="btn btn-info btn-lg primary" onclick="return trackOutboundLink('post learn more hover', 'https://amzn.to/38s1oCK', event);">Buy the Book</a>
        <a target="_blank" rel="noopener" href="https://www.ebooks.com/en-us/209820951/effective-typescript/dan-vanderkam/?_c=1" class="btn btn-info btn-lg hidden-xs" onclick="return trackOutboundLink('post learn more hover', 'https://www.ebooks.com/en-us/209820951/effective-typescript/dan-vanderkam/?_c=1', event);">Buy eBook</a>
        <a href="/mail/" class="btn btn-info btn-lg" onclick="return trackOutboundLink('post learn more hover', '/mail/', event);">Subscribe</a>
      </div>
    </div>
  </div>

  <div class="page-content">
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <a target="_blank" rel="noopener" href="https://amzn.to/38s1oCK" onclick="return trackOutboundLink('post learn more cover image', 'https://amzn.to/38s1oCK', event);">
            <img src="/images/cover.jpg" class="learn-more-photo" alt="Effective TypeScript Book Cover">
          </a>
          <p><strong><em>Effective TypeScript</em></strong> shows you not just <em>how</em> to use TypeScript but how to use it <em>well</em>. The book&#39;s 62 items help you build mental models of how TypeScript and its ecosystem work, make you aware of pitfalls and traps to avoid, and guide you toward using TypeScriptâ€™s many capabilities in the most effective ways possible. Regardless of your level of TypeScript experience, you can learn something from this book.</p>
<p>After reading <em>Effective TypeScript</em>, your relationship with the type system will be the most productive it&#39;s ever been! <a href="/">Learn more Â»</a></p>

        </div>
      </div>
    </div>
  </div>

</section>

  <footer id="contentinfo" class="footer">
  <div class="container">
    <address id="about" class="vcard body">
      &copy; 2019 - 2022 <a class="url fn" target="_blank" rel="noopener" href="https://danvk.org" onclick="trackOutboundLink('footer', 'https://danvk.org'); return false;">Dan Vanderkam</a>
      <div class="footer-attribution">Powered by <a href="https://hexo.io/" target="_blank" onclick="return trackOutboundLink('conclusions', 'https://hexo.io/', event);">Hexo</a></div>
    </address>
  </div>
</footer>
</body>
</html>
